<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#0d0d15">
    <title>Realms&Scripts - Ficha</title>
    <link rel="stylesheet" href="css/mobile.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
</head>
<body>
    <!-- ==================== SPLASH SCREEN ==================== -->
    <div id="splashScreen" class="splash-screen">
        <div class="splash-content">
            <i class="fas fa-scroll splash-icon"></i>
            <h1>Realms&Scripts</h1>
            <div class="splash-loader"></div>
        </div>
    </div>

    <!-- ==================== AUTH MODAL ==================== -->
    <div id="authModal" class="modal hidden">
        <div class="modal-content">
            <div class="auth-header">
                <i class="fas fa-scroll"></i>
                <h1>Realms&Scripts</h1>
            </div>
            
            <div class="auth-tabs">
                <button class="auth-tab active" data-tab="login">Entrar</button>
                <button class="auth-tab" data-tab="register">Cadastrar</button>
            </div>
            
            <form id="loginForm" class="auth-form">
                <div class="form-group">
                    <label for="loginEmail">Email</label>
                    <input type="email" id="loginEmail" required placeholder="seu@email.com">
                </div>
                <div class="form-group">
                    <label for="loginPassword">Senha</label>
                    <input type="password" id="loginPassword" required placeholder="••••••••">
                </div>
                <button type="submit" class="btn-primary">
                    <i class="fas fa-sign-in-alt"></i> Entrar
                </button>
            </form>
            
            <form id="registerForm" class="auth-form hidden">
                <div class="form-group">
                    <label for="registerName">Nome</label>
                    <input type="text" id="registerName" required placeholder="Seu nome">
                </div>
                <div class="form-group">
                    <label for="registerEmail">Email</label>
                    <input type="email" id="registerEmail" required placeholder="seu@email.com">
                </div>
                <div class="form-group">
                    <label for="registerPassword">Senha</label>
                    <input type="password" id="registerPassword" required minlength="6" placeholder="Mínimo 6 caracteres">
                </div>
                <button type="submit" class="btn-primary">
                    <i class="fas fa-user-plus"></i> Cadastrar
                </button>
            </form>
        </div>
    </div>

    <!-- ==================== CHARACTER SELECT MODAL ==================== -->
    <div id="characterModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-users"></i> Suas Fichas</h2>
            </div>
            <div id="characterList" class="character-list"></div>
            <div class="modal-actions">
                <button id="newCharacterBtn" class="btn-primary">
                    <i class="fas fa-plus"></i> Nova Ficha
                </button>
                <button id="logoutBtn" class="btn-secondary">
                    <i class="fas fa-sign-out-alt"></i> Sair
                </button>
            </div>
        </div>
    </div>

    <!-- ==================== MAIN APP ==================== -->
    <main id="mainApp" class="main-app hidden">
        <!-- Header -->
        <header class="app-header">
            <button id="menuBtn" class="header-btn">
                <i class="fas fa-bars"></i>
            </button>
            <h1 id="charName" class="char-name">Personagem</h1>
            <button id="saveIndicator" class="header-btn save-indicator">
                <i class="fas fa-cloud-upload-alt"></i>
            </button>
        </header>

        <!-- Quick Stats Bar -->
        <div class="quick-stats">
            <div class="quick-stat hp" onclick="App.openResourceModal('hp')">
                <i class="fas fa-heart"></i>
                <span id="quickHp">20/20</span>
            </div>
            <div class="quick-stat pe" onclick="App.openResourceModal('pe')">
                <i class="fas fa-bolt"></i>
                <span id="quickPe">6/6</span>
            </div>
            <div class="quick-stat san" onclick="App.openResourceModal('san')">
                <i class="fas fa-brain"></i>
                <span id="quickSan">20</span>
            </div>
            <div class="quick-stat pa" onclick="App.openResourceModal('pa')">
                <i class="fas fa-running"></i>
                <span id="quickPa">5</span>
            </div>
        </div>

        <!-- Tab Content -->
        <div class="tab-container">
            <!-- TAB: PERSONAGEM -->
            <section id="tabPersonagem" class="tab-content active">
                <!-- Info Card -->
                <div class="card">
                    <div class="card-header">
                        <i class="fas fa-user"></i> Informações
                    </div>
                    <div class="card-body">
                        <div class="form-row">
                            <div class="form-group flex-2">
                                <label>Nome</label>
                                <input type="text" id="charNameInput" data-field="charName" placeholder="Nome do personagem">
                            </div>
                            <div class="form-group flex-1">
                                <label>Nível</label>
                                <input type="number" id="charLevel" data-field="charLevel" min="1" max="20" value="1">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Raça</label>
                                <select id="charRace" data-field="charRace">
                                    <option value="humano">Humano</option>
                                    <option value="elfo">Elfo</option>
                                    <option value="anao">Anão</option>
                                    <option value="demonio">Demônio</option>
                                </select>
                            </div>
                        </div>
                        <div id="raceInfo" class="race-info"></div>
                    </div>
                </div>

                <!-- Attributes Card -->
                <div class="card">
                    <div class="card-header">
                        <i class="fas fa-fist-raised"></i> Atributos
                        <span class="attr-points">(<span id="usedAttrPoints">0</span>/8)</span>
                    </div>
                    <div class="card-body">
                        <div class="attributes-grid">
                            <div class="attr-item">
                                <label>FOR</label>
                                <input type="number" id="attrFor" data-field="attrFor" value="0" min="-3" max="5">
                                <div class="attr-buttons">
                                    <button class="attr-btn minus" data-attr="attrFor"><i class="fas fa-minus"></i></button>
                                    <button class="attr-btn plus" data-attr="attrFor"><i class="fas fa-plus"></i></button>
                                </div>
                            </div>
                            <div class="attr-item">
                                <label>CON</label>
                                <input type="number" id="attrCon" data-field="attrCon" value="0" min="-3" max="5">
                                <div class="attr-buttons">
                                    <button class="attr-btn minus" data-attr="attrCon"><i class="fas fa-minus"></i></button>
                                    <button class="attr-btn plus" data-attr="attrCon"><i class="fas fa-plus"></i></button>
                                </div>
                            </div>
                            <div class="attr-item">
                                <label>VON</label>
                                <input type="number" id="attrVon" data-field="attrVon" value="0" min="-3" max="5">
                                <div class="attr-buttons">
                                    <button class="attr-btn minus" data-attr="attrVon"><i class="fas fa-minus"></i></button>
                                    <button class="attr-btn plus" data-attr="attrVon"><i class="fas fa-plus"></i></button>
                                </div>
                            </div>
                            <div class="attr-item">
                                <label>CAR</label>
                                <input type="number" id="attrCar" data-field="attrCar" value="0" min="-3" max="5">
                                <div class="attr-buttons">
                                    <button class="attr-btn minus" data-attr="attrCar"><i class="fas fa-minus"></i></button>
                                    <button class="attr-btn plus" data-attr="attrCar"><i class="fas fa-plus"></i></button>
                                </div>
                            </div>
                            <div class="attr-item">
                                <label>INT</label>
                                <input type="number" id="attrInt" data-field="attrInt" value="0" min="-3" max="5">
                                <div class="attr-buttons">
                                    <button class="attr-btn minus" data-attr="attrInt"><i class="fas fa-minus"></i></button>
                                    <button class="attr-btn plus" data-attr="attrInt"><i class="fas fa-plus"></i></button>
                                </div>
                            </div>
                            <div class="attr-item">
                                <label>AGI</label>
                                <input type="number" id="attrAgi" data-field="attrAgi" value="0" min="-3" max="5">
                                <div class="attr-buttons">
                                    <button class="attr-btn minus" data-attr="attrAgi"><i class="fas fa-minus"></i></button>
                                    <button class="attr-btn plus" data-attr="attrAgi"><i class="fas fa-plus"></i></button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Resources Card -->
                <div class="card">
                    <div class="card-header">
                        <i class="fas fa-heart"></i> Recursos
                    </div>
                    <div class="card-body">
                        <div class="resources-grid">
                            <!-- HP -->
                            <div class="resource-item hp">
                                <div class="resource-header">
                                    <span class="resource-label"><i class="fas fa-heart"></i> HP</span>
                                    <span class="resource-values">
                                        <input type="number" id="currentHp" data-field="currentHp" class="resource-current" value="20">
                                        <span>/</span>
                                        <span id="maxHp" class="resource-max">20</span>
                                    </span>
                                </div>
                                <div class="resource-bar">
                                    <div id="hpBar" class="bar-fill hp-fill" style="width: 100%"></div>
                                </div>
                                <div class="resource-actions">
                                    <button class="res-btn damage" onclick="App.modifyResource('hp', -5)">-5</button>
                                    <button class="res-btn damage" onclick="App.modifyResource('hp', -1)">-1</button>
                                    <button class="res-btn heal" onclick="App.modifyResource('hp', 1)">+1</button>
                                    <button class="res-btn heal" onclick="App.modifyResource('hp', 5)">+5</button>
                                </div>
                            </div>

                            <!-- PE -->
                            <div class="resource-item pe">
                                <div class="resource-header">
                                    <span class="resource-label"><i class="fas fa-bolt"></i> PE</span>
                                    <span class="resource-values">
                                        <input type="number" id="currentPe" data-field="currentPe" class="resource-current" value="6">
                                        <span>/</span>
                                        <span id="maxPe" class="resource-max">6</span>
                                    </span>
                                </div>
                                <div class="resource-bar">
                                    <div id="peBar" class="bar-fill pe-fill" style="width: 100%"></div>
                                </div>
                                <div class="resource-actions">
                                    <button class="res-btn damage" onclick="App.modifyResource('pe', -3)">-3</button>
                                    <button class="res-btn damage" onclick="App.modifyResource('pe', -1)">-1</button>
                                    <button class="res-btn heal" onclick="App.modifyResource('pe', 1)">+1</button>
                                    <button class="res-btn heal" onclick="App.modifyResource('pe', 3)">+3</button>
                                </div>
                            </div>

                            <!-- Sanidade -->
                            <div class="resource-item san">
                                <div class="resource-header">
                                    <span class="resource-label"><i class="fas fa-brain"></i> Sanidade</span>
                                    <span class="resource-values">
                                        <input type="number" id="sanity" data-field="sanity" class="resource-current" value="20">
                                    </span>
                                </div>
                                <div class="resource-actions">
                                    <button class="res-btn damage" onclick="App.modifyResource('san', -5)">-5</button>
                                    <button class="res-btn damage" onclick="App.modifyResource('san', -1)">-1</button>
                                    <button class="res-btn heal" onclick="App.modifyResource('san', 1)">+1</button>
                                    <button class="res-btn heal" onclick="App.modifyResource('san', 5)">+5</button>
                                </div>
                            </div>

                            <!-- PA -->
                            <div class="resource-item pa">
                                <div class="resource-header">
                                    <span class="resource-label"><i class="fas fa-running"></i> PA</span>
                                    <span class="resource-values">
                                        <input type="number" id="currentPa" data-field="currentPa" class="resource-current" value="5">
                                        <span>/</span>
                                        <span id="maxPa" class="resource-max">5</span>
                                    </span>
                                </div>
                                <div class="resource-actions">
                                    <button class="res-btn damage" onclick="App.modifyResource('pa', -1)">-1</button>
                                    <button class="res-btn heal" onclick="App.resetPa()">Reset</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- TAB: COMBATE -->
            <section id="tabCombate" class="tab-content">
                <!-- Combat Resources -->
                <div class="card">
                    <div class="card-header">
                        <i class="fas fa-heart-pulse"></i> Recursos de Combate
                    </div>
                    <div class="card-body">
                        <div class="combat-resources-grid">
                            <div class="combat-resource hp">
                                <div class="combat-res-label"><i class="fas fa-heart"></i> HP</div>
                                <div class="combat-res-values">
                                    <input type="number" id="combatHp" class="combat-res-input" value="20" onchange="App.updateCombatResource('hp', this.value)">
                                    <span>/</span>
                                    <span id="combatMaxHp">20</span>
                                </div>
                                <div class="combat-res-bar">
                                    <div id="combatHpBar" class="bar-fill hp-fill" style="width: 100%"></div>
                                </div>
                                <div class="combat-res-btns">
                                    <button onclick="App.modifyResource('hp', -5)">-5</button>
                                    <button onclick="App.modifyResource('hp', -1)">-1</button>
                                    <button onclick="App.modifyResource('hp', 1)">+1</button>
                                    <button onclick="App.modifyResource('hp', 5)">+5</button>
                                </div>
                            </div>
                            <div class="combat-resource pe">
                                <div class="combat-res-label"><i class="fas fa-bolt"></i> PE</div>
                                <div class="combat-res-values">
                                    <input type="number" id="combatPe" class="combat-res-input" value="6" onchange="App.updateCombatResource('pe', this.value)">
                                    <span>/</span>
                                    <span id="combatMaxPe">6</span>
                                </div>
                                <div class="combat-res-bar">
                                    <div id="combatPeBar" class="bar-fill pe-fill" style="width: 100%"></div>
                                </div>
                                <div class="combat-res-btns">
                                    <button onclick="App.modifyResource('pe', -3)">-3</button>
                                    <button onclick="App.modifyResource('pe', -1)">-1</button>
                                    <button onclick="App.modifyResource('pe', 1)">+1</button>
                                    <button onclick="App.modifyResource('pe', 3)">+3</button>
                                </div>
                            </div>
                            <div class="combat-resource san">
                                <div class="combat-res-label"><i class="fas fa-brain"></i> SAN</div>
                                <div class="combat-res-values">
                                    <input type="number" id="combatSan" class="combat-res-input" value="20" onchange="App.updateCombatResource('san', this.value)">
                                </div>
                                <div class="combat-res-btns">
                                    <button onclick="App.modifyResource('san', -5)">-5</button>
                                    <button onclick="App.modifyResource('san', -1)">-1</button>
                                    <button onclick="App.modifyResource('san', 1)">+1</button>
                                    <button onclick="App.modifyResource('san', 5)">+5</button>
                                </div>
                            </div>
                            <div class="combat-resource pa">
                                <div class="combat-res-label"><i class="fas fa-running"></i> PA</div>
                                <div class="combat-res-values">
                                    <input type="number" id="combatPa" class="combat-res-input" value="5" onchange="App.updateCombatResource('pa', this.value)">
                                    <span>/</span>
                                    <span id="combatMaxPa">5</span>
                                </div>
                                <div class="combat-res-btns">
                                    <button onclick="App.modifyResource('pa', -1)">-1</button>
                                    <button onclick="App.resetPa()">Reset</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Combat Stats -->
                <div class="card">
                    <div class="card-header">
                        <i class="fas fa-shield-alt"></i> Estatísticas
                    </div>
                    <div class="card-body">
                        <div class="combat-stats-grid">
                            <div class="combat-stat">
                                <div class="stat-value" id="combatCA">10</div>
                                <div class="stat-label">DA</div>
                            </div>
                            <div class="combat-stat">
                                <div class="stat-value" id="combatDodge">10</div>
                                <div class="stat-label">Esquiva</div>
                            </div>
                            <div class="combat-stat">
                                <div class="stat-value" id="combatInit">0</div>
                                <div class="stat-label">Iniciativa</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Armor -->
                <div class="card">
                    <div class="card-header">
                        <i class="fas fa-tshirt"></i> Armadura
                    </div>
                    <div class="card-body">
                        <select id="armorType" data-field="armorType" class="armor-select">
                            <option value="none">Sem Armadura (CA +0)</option>
                            <option value="light">Leve (CA +3)</option>
                            <option value="medium">Média (CA +5, -2 perícias, -1 PA)</option>
                            <option value="heavy">Pesada (CA +7, -5 perícias, -3 PA)</option>
                        </select>
                    </div>
                </div>

                <!-- Attacks -->
                <div class="card">
                    <div class="card-header">
                        <i class="fas fa-crosshairs"></i> Ataques
                    </div>
                    <div class="card-body">
                        <div id="attacksList" class="attacks-list">
                            <!-- Attacks will be generated here -->
                        </div>
                        <button class="add-item-btn" onclick="App.addAttack()">
                            <i class="fas fa-plus"></i> Adicionar Ataque
                        </button>
                    </div>
                </div>

                <!-- Combat Skills -->
                <div class="card">
                    <div class="card-header">
                        <i class="fas fa-bullseye"></i> Perícias de Combate
                    </div>
                    <div class="card-body">
                        <div class="combat-skills-grid">
                            <div class="combat-skill-item" onclick="App.rollSkill('luta')">
                                <span class="skill-name">Luta</span>
                                <span class="skill-total" id="skillLuta">+0</span>
                            </div>
                            <div class="combat-skill-item" onclick="App.rollSkill('pontaria')">
                                <span class="skill-name">Pontaria</span>
                                <span class="skill-total" id="skillPontaria">+0</span>
                            </div>
                            <div class="combat-skill-item" onclick="App.rollSkill('reflexos')">
                                <span class="skill-name">Reflexos</span>
                                <span class="skill-total" id="skillReflexos">+0</span>
                            </div>
                            <div class="combat-skill-item" onclick="App.rollSkill('iniciativa')">
                                <span class="skill-name">Iniciativa</span>
                                <span class="skill-total" id="skillIniciativa">+0</span>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- TAB: PERÍCIAS -->
            <section id="tabPericias" class="tab-content">
                <div class="card">
                    <div class="card-header">
                        <i class="fas fa-search"></i>
                        <input type="text" id="skillSearch" class="skill-search" placeholder="Buscar perícia...">
                    </div>
                    <div class="card-body">
                        <div id="skillsList" class="skills-list">
                            <!-- Skills will be generated here -->
                        </div>
                    </div>
                </div>
            </section>

            <!-- TAB: FUSÕES -->
            <section id="tabFusoes" class="tab-content">
                <!-- Heart, Brain & Eyes -->
                <div class="card">
                    <div class="card-header">
                        <i class="fas fa-dna"></i> Fusões Vitais
                    </div>
                    <div class="card-body">
                        <div class="fusion-select-grid">
                            <div class="fusion-select-item heart">
                                <label class="fusion-select-label">
                                    <i class="fas fa-heart"></i> Coração
                                </label>
                                <select id="fusionHeart" data-field="fusionHeart" class="fusion-select">
                                    <option value="vermelho">Vermelho (Nível 1)</option>
                                    <option value="rosaEscuro">Rosa Escuro (Nível 3)</option>
                                    <option value="rosaProfundo">Rosa Profundo (Nível 6)</option>
                                    <option value="rosaShock">Rosa Shock (Nível 10)</option>
                                    <option value="rosaClaro">Rosa Claro (Nível 13)</option>
                                    <option value="prata">Prata (Nível 16)</option>
                                    <option value="branco">Branco (Nível 20)</option>
                                </select>
                                <div class="fusion-effect-text" id="heartEffect">HP Base: 20</div>
                            </div>
                            <div class="fusion-select-item brain">
                                <label class="fusion-select-label">
                                    <i class="fas fa-brain"></i> Cérebro
                                </label>
                                <select id="fusionBrain" data-field="fusionBrain" class="fusion-select">
                                    <option value="vermelho">Vermelho (Nível 1)</option>
                                    <option value="rosaEscuro">Rosa Escuro (Nível 3)</option>
                                    <option value="rosaProfundo">Rosa Profundo (Nível 6)</option>
                                    <option value="rosaShock">Rosa Shock (Nível 10)</option>
                                    <option value="rosaClaro">Rosa Claro (Nível 13)</option>
                                    <option value="prata">Prata (Nível 16)</option>
                                    <option value="branco">Branco (Nível 20)</option>
                                </select>
                                <div class="fusion-effect-text" id="brainEffect">PE Base: 6</div>
                            </div>
                            <div class="fusion-select-item eye">
                                <label class="fusion-select-label">
                                    <i class="fas fa-eye"></i> Olhos
                                </label>
                                <select id="fusionEyes" data-field="fusionEyes" class="fusion-select">
                                    <option value="nao">Não Fundido</option>
                                    <option value="fundido">Fundido</option>
                                </select>
                                <div class="fusion-effect-text" id="eyesEffect">Sem bônus</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Muscles -->
                <div class="card">
                    <div class="card-header">
                        <i class="fas fa-dumbbell"></i> Músculos
                    </div>
                    <div class="card-body">
                        <div class="fusion-body-grid">
                            <div class="fusion-body-item">
                                <label><i class="fas fa-hand-fist"></i> Braços</label>
                                <select id="fusionMuscleArms" data-field="fusionMuscleArms" class="fusion-select-sm">
                                    <option value="vermelho">Vermelho</option>
                                    <option value="rosaProfundo">Rosa Profundo</option>
                                    <option value="rosaClaro">Rosa Claro</option>
                                    <option value="prata">Prata</option>
                                    <option value="branco">Branco</option>
                                </select>
                            </div>
                            <div class="fusion-body-item">
                                <label><i class="fas fa-head-side"></i> Cabeça</label>
                                <select id="fusionMuscleHead" data-field="fusionMuscleHead" class="fusion-select-sm">
                                    <option value="vermelho">Vermelho</option>
                                    <option value="rosaProfundo">Rosa Profundo</option>
                                    <option value="rosaClaro">Rosa Claro</option>
                                    <option value="prata">Prata</option>
                                    <option value="branco">Branco</option>
                                </select>
                            </div>
                            <div class="fusion-body-item">
                                <label><i class="fas fa-person"></i> Costas</label>
                                <select id="fusionMuscleBack" data-field="fusionMuscleBack" class="fusion-select-sm">
                                    <option value="vermelho">Vermelho</option>
                                    <option value="rosaProfundo">Rosa Profundo</option>
                                    <option value="rosaClaro">Rosa Claro</option>
                                    <option value="prata">Prata</option>
                                    <option value="branco">Branco</option>
                                </select>
                            </div>
                            <div class="fusion-body-item">
                                <label><i class="fas fa-vest"></i> Peito</label>
                                <select id="fusionMuscleChest" data-field="fusionMuscleChest" class="fusion-select-sm">
                                    <option value="vermelho">Vermelho</option>
                                    <option value="rosaProfundo">Rosa Profundo</option>
                                    <option value="rosaClaro">Rosa Claro</option>
                                    <option value="prata">Prata</option>
                                    <option value="branco">Branco</option>
                                </select>
                            </div>
                            <div class="fusion-body-item">
                                <label><i class="fas fa-socks"></i> Pernas</label>
                                <select id="fusionMuscleLegs" data-field="fusionMuscleLegs" class="fusion-select-sm">
                                    <option value="vermelho">Vermelho</option>
                                    <option value="rosaProfundo">Rosa Profundo</option>
                                    <option value="rosaClaro">Rosa Claro</option>
                                    <option value="prata">Prata</option>
                                    <option value="branco">Branco</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Bones -->
                <div class="card">
                    <div class="card-header">
                        <i class="fas fa-bone"></i> Ossos
                    </div>
                    <div class="card-body">
                        <div class="fusion-body-grid">
                            <div class="fusion-body-item">
                                <label><i class="fas fa-hand-fist"></i> Braços</label>
                                <select id="fusionBoneArms" data-field="fusionBoneArms" class="fusion-select-sm">
                                    <option value="comeco">Começo</option>
                                    <option value="transiente">Transiente</option>
                                    <option value="mesclado">Mesclado</option>
                                    <option value="integrado">Integrado</option>
                                    <option value="fundido">Fundido</option>
                                </select>
                            </div>
                            <div class="fusion-body-item">
                                <label><i class="fas fa-head-side"></i> Cabeça</label>
                                <select id="fusionBoneHead" data-field="fusionBoneHead" class="fusion-select-sm">
                                    <option value="comeco">Começo</option>
                                    <option value="transiente">Transiente</option>
                                    <option value="mesclado">Mesclado</option>
                                    <option value="integrado">Integrado</option>
                                    <option value="fundido">Fundido</option>
                                </select>
                            </div>
                            <div class="fusion-body-item">
                                <label><i class="fas fa-person"></i> Costas</label>
                                <select id="fusionBoneBack" data-field="fusionBoneBack" class="fusion-select-sm">
                                    <option value="comeco">Começo</option>
                                    <option value="transiente">Transiente</option>
                                    <option value="mesclado">Mesclado</option>
                                    <option value="integrado">Integrado</option>
                                    <option value="fundido">Fundido</option>
                                </select>
                            </div>
                            <div class="fusion-body-item">
                                <label><i class="fas fa-vest"></i> Peito</label>
                                <select id="fusionBoneChest" data-field="fusionBoneChest" class="fusion-select-sm">
                                    <option value="comeco">Começo</option>
                                    <option value="transiente">Transiente</option>
                                    <option value="mesclado">Mesclado</option>
                                    <option value="integrado">Integrado</option>
                                    <option value="fundido">Fundido</option>
                                </select>
                            </div>
                            <div class="fusion-body-item">
                                <label><i class="fas fa-socks"></i> Pernas</label>
                                <select id="fusionBoneLegs" data-field="fusionBoneLegs" class="fusion-select-sm">
                                    <option value="comeco">Começo</option>
                                    <option value="transiente">Transiente</option>
                                    <option value="mesclado">Mesclado</option>
                                    <option value="integrado">Integrado</option>
                                    <option value="fundido">Fundido</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Fusion Summary -->
                <div class="card">
                    <div class="card-header">
                        <i class="fas fa-shield-alt"></i> Resumo de Fusões
                    </div>
                    <div class="card-body">
                        <div class="fusion-summary">
                            <div class="summary-item">
                                <span>Redução ao Defender (Braços):</span>
                                <span id="defendReduction">0</span>
                            </div>
                            <div class="summary-item">
                                <span>Red. Dano Geral (Média):</span>
                                <span id="damageReduction">0</span>
                            </div>
                            <div class="summary-item">
                                <span>Red. Dano de Queda (Pernas):</span>
                                <span id="fallReduction">0</span>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- TAB: INVENTÁRIO -->
            <section id="tabInventario" class="tab-content">
                <div class="card">
                    <div class="card-header">
                        <i class="fas fa-weight-hanging"></i> Carga
                        <span class="weight-info">
                            <span id="currentWeight">0</span>/<span id="maxWeight">12</span> kg
                        </span>
                    </div>
                    <div class="card-body">
                        <div class="weight-bar">
                            <div id="weightBar" class="bar-fill weight-fill"></div>
                            <div id="heavyMark" class="heavy-mark"></div>
                        </div>
                        <div id="weightStatus" class="weight-status">Normal</div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <i class="fas fa-box-open"></i> Inventário
                    </div>
                    <div class="card-body">
                        <div class="inventory-header">
                            <span class="inv-col-name">Item</span>
                            <span class="inv-col-weight">Peso</span>
                            <span class="inv-col-qty">Qtd</span>
                            <span class="inv-col-action"></span>
                        </div>
                        <div id="inventoryList" class="inventory-list">
                            <!-- Items will be generated here -->
                        </div>
                        <button class="add-item-btn" onclick="App.addItem()">
                            <i class="fas fa-plus"></i> Adicionar Item
                        </button>
                    </div>
                </div>

                <!-- Money -->
                <div class="card">
                    <div class="card-header">
                        <i class="fas fa-coins"></i> Dinheiro
                    </div>
                    <div class="card-body">
                        <div class="money-section">
                            <div class="money-display">
                                <i class="fas fa-coins money-icon"></i>
                                <div class="money-amount">
                                    <input type="number" id="money" data-field="money" placeholder="0" min="0">
                                    <span class="money-currency">$</span>
                                </div>
                            </div>
                            <p class="money-hint">Moeda padrão do sistema</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- TAB: NOTAS -->
            <section id="tabNotas" class="tab-content">
                <div class="card">
                    <div class="card-header">
                        <i class="fas fa-book"></i> História
                    </div>
                    <div class="card-body">
                        <textarea id="charHistory" data-field="charHistory" class="notes-textarea" placeholder="Escreva a história do seu personagem..."></textarea>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <i class="fas fa-sticky-note"></i> Anotações
                    </div>
                    <div class="card-body">
                        <textarea id="charNotes" data-field="charNotes" class="notes-textarea" placeholder="Anotações da sessão..."></textarea>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <i class="fas fa-star"></i> Habilidades & Poderes
                    </div>
                    <div class="card-body">
                        <textarea id="charAbilities" data-field="charAbilities" class="notes-textarea" placeholder="Liste suas habilidades especiais e poderes..."></textarea>
                    </div>
                </div>
            </section>
        </div>

        <!-- Bottom Navigation -->
        <nav class="bottom-nav">
            <button class="nav-btn active" data-tab="Personagem">
                <i class="fas fa-user"></i>
                <span>Ficha</span>
            </button>
            <button class="nav-btn" data-tab="Combate">
                <i class="fas fa-khanda"></i>
                <span>Combate</span>
            </button>
            <button class="nav-btn" data-tab="Pericias">
                <i class="fas fa-book-open"></i>
                <span>Perícias</span>
            </button>
            <button class="nav-btn" data-tab="Fusoes">
                <i class="fas fa-dna"></i>
                <span>Fusões</span>
            </button>
            <button class="nav-btn" data-tab="Inventario">
                <i class="fas fa-box-open"></i>
                <span>Itens</span>
            </button>
            <button class="nav-btn" data-tab="Notas">
                <i class="fas fa-scroll"></i>
                <span>Notas</span>
            </button>
        </nav>
    </main>

    <!-- ==================== SIDE MENU ==================== -->
    <div id="sideMenu" class="side-menu">
        <div class="side-menu-content">
            <div class="side-menu-header">
                <span id="menuUserName">Usuário</span>
                <button class="close-menu" onclick="App.closeSideMenu()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="side-menu-options">
                <div class="menu-option">
                    <span class="option-label"><i class="fas fa-dice"></i> Rolagens de Dados</span>
                    <label class="toggle-switch">
                        <input type="checkbox" id="diceRollToggle" checked onchange="App.toggleDiceRolls(this.checked)">
                        <span class="toggle-slider"></span>
                    </label>
                </div>
            </div>
            <div class="side-menu-actions">
                <button onclick="App.showCharacterModal()">
                    <i class="fas fa-exchange-alt"></i> Trocar Ficha
                </button>
                <button onclick="App.exportCharacter()">
                    <i class="fas fa-download"></i> Exportar Ficha
                </button>
                <button class="danger" onclick="App.deleteCurrentCharacter()">
                    <i class="fas fa-trash"></i> Deletar Ficha
                </button>
            </div>
            <div class="side-menu-footer">
                <button onclick="App.logout()">
                    <i class="fas fa-sign-out-alt"></i> Sair
                </button>
            </div>
        </div>
    </div>
    <div id="sideMenuOverlay" class="side-menu-overlay" onclick="App.closeSideMenu()"></div>

    <!-- ==================== DICE ROLL MODAL ==================== -->
    <div id="diceModal" class="modal hidden">
        <div class="modal-content dice-modal">
            <div class="dice-result">
                <div class="dice-icon"><i class="fas fa-dice-d20"></i></div>
                <div id="diceTotal" class="dice-total">20</div>
                <div id="diceBreakdown" class="dice-breakdown">1d20 + 5</div>
            </div>
            <button class="btn-primary" onclick="App.closeDiceModal()">Fechar</button>
        </div>
    </div>

    <!-- ==================== SCRIPTS ==================== -->
    <script src="js/firebase-config.js"></script>
    <script src="js/main.js"></script>
</body>
</html>
